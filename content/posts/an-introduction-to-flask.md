---
title: "مقدمه‌ای بر فلسک"
date: 2020-09-04T11:14:14+04:30
draft: true
author: "arianmonti"
authorLink: ""
description: "معرفی میکروفریمورک فلسک"
tags: ['flask']
---
پایتون یه زبان برنامه‌نویسی آزاده که به خاظر کتابخونه هاش و طبعا فعال بودن توی حوزه های بسیار مختلف مشهوره. یکی از حوزه‌‌ها‌یی که پایتون توش خیلی مشهوره وب دولپمنته. راستش pure پایتون کد زدن برای توسعه‌دهندگی(!) وب اونقدر ها هم جذاب نیست. در واقع با کتابخونه‌ی WSGI میشه برنامه های وب پایتون نوشت. شاید در حد Hello, World! جالب باشه ولی اگه بخواین واقعا یه برنامه بزرگ بنویسید دیگه اونقدر فان نیست. خب پس چی کار کنیم؟ برای این کار میریم سراغ framework های وب پایتون:
- Django
- Flask
- Web2Py
- CherryPy
- TurboGears
- Pyramid
- Bottle
- Growler
- Hug
- Dash
- Falcon
- Pylons
- Sanic
- Tornado
...
همون طور که گفتم کتابخونه های پایتون بسیار متنوع و زیادن. پس کدوم رو انتخاب کنیم؟ میتونید خودتون تک تک این فریمورک ها رو انتخاب کنید و از هر کدوم خوشتون اومد توش پیش برید. ولی فریمورک‌هایی که من قراره معرفی شون کنم... فعلا فقط فلسکه. اما شاید یه روزی درباره جنگو هم کمی حرف بزنم. شاید اون روز امروز باشه. به هر حال

## معرفی فلسک
فلسک یه میکروفریمورک وب پایتونه. در واقع فریمورک به معنی چهارچوبه. یعنی این که من یه سری امکانات رو برات فراهم می‌کنم ولی باید طبق چهارچوب من کد بنویسی. برای چی میگیم که فلسک یه میکروفریمورکه؟ برای این که امکانات مینیمال(ولی قوی) رو در اختیارتون می‌ذاره و دست شما بسیار بازه. اگه با جنگو کار کرده باشید می‌دونید که قضیه این شکلیه که با یه دستور پروژه رو می‌سازه, یه سری فایل درست می‌کنه, و تو اون فایل‌ها یه چیزی می‌نویسه که منطقا کار شما رو راحت‌ می‌کنن. علاوه بر اون برای شما یه دیزاین‌پترن, دیتابیس دیفالت و کلی چیز دیگه رو آماده می‌کنه. فلسک این طوری نیست. اگه نخواید خیلی اپ خوشگلی درست کنید, یا جینگولک بازی های دیگه‌ای مثل migration و ... نداشته باشید, کل اپ فلسک شما تو یه فایل جا می‌شه. بذارید توضیحات بیشتری درباره خود فلسک بدم.

فلسک توسط Armin Ronacher در روز اول آوریل سال ۲۰۱۰ منتشر شد. تاریخش براتون آشنا نیست؟ درسته. فلسک در واقع یک دروغ اول آوریل بوده که شوخی شوخی جدی شده. در واقع فلسک بر پایه دو تا کتابخونه ساخته شده که هر دو نوشته Armin Ronacher هستن:
- Werkzeug: چند خط بالا به WSGI اشاره کردم این کتابخونه مجموعه ابزار برای WSGI
- Jinja: که اسم خیلی باحال هم داره یک template engine. یعنی می‌تونه برای استفاده متغیر‌ها در HTML, عبارت‌های شرطی و ... رو پوشش بده.

راستی, فلسک تا حالا بیشترین star رو در بین فریمورک‌های وب پایتون با ۵۱۹۰۰ توی گیت‌هاب داره.

## چرا فلسک
* می‌تونیم به همون دلیل 'چرا پایتون' رجوع کنیم: ساده برای تازه‌کارها و خوب برای پیشرفته‌ها
* از فلسک خوشتون میاد
* می‌تونید روی اپتون کنترل زیاد داشته باشید
* شرکت هایی مثل
    - Reh Hat
    - Aairbnb 
    - Netflix
    - Reddit
    - MIT
    - Mozilla
    - Patreon
    - Uber
    - Nginx
از فلسک استفاده می‌کنن. منبعش [اینجاست](https://stackshare.io/flask)
* فلسک برای توسعه میکروسرویس‌ها خیلی گزینه خوبیه
*  فلسک برای توسعه اپ های بزرگ خیلی گزینه خوبیه(خیلی scalable)
> به حرف کسایی که میگن جنگو برای اپ های بزرگه و فلسک برای اپ های کوچیک خوبه گوش نکنین. فلسک می‌تونه به افزونه هایی که داره به راحتی بزرگ بشه و به framework شبیه بشه. درسته راه اندازی اپ های بزرگ با جنگو خیلی سریع تره.
* فلسک برای خیلی از کتابخونه های خوب پایتون افزونه داره
* فلسک با کتابخونه هایی که براش افزونه نداره سازگاره
* ...
## سلام دنیا
بیاین با هم یه برنامه ساده Hello, World! فلسک رو ببینیم:

```  Python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
    return 'Hello, World!'
```

خط اول کلاس `Flask` رو از کتابخونه `flask` ایمپورت می‌کنه. خیلی مهمه که توجه کنیم به uppercase و lowercase بودن این دو تا.

خط سوم یه `instance` از کلاس `Flask` با مقدار `__name__` میسازه. اول باید ببینیم کا کلاس `Flask` چیه. این کلاس در واقع مقدمات اپ شما آماده می‌کنه و کل اپ ما بر اساس این `instance` انجام میشه. کد کلاس فلسک رو می‌تونین
[اینجا](https://github.com/pallets/flask/blob/a1fb8f143f5deb545a10ac2758cb7a2b2bd68df3/src/flask/app.py#L62)
ببینین. در واقع کل
[این](https://github.com/pallets/flask/blob/a1fb8f143f5deb545a10ac2758cb7a2b2bd68df3/src/flask/app.py)
فایل کلاس `Flask` رو تعریف میکنه. اگه یه نگاهی به کد این کلاس بندازین می‌بینین که یه سری متغیر   مثل `config_class` و `secret_key` و ‍‍‍‍‍‍‍‍‍‍‍‍‍‍`default_config` و `template_folder` و `root_path` رو تعریف می‌کنه که بعدا قابل تغییر هستن. بعد از اون هم متد های کلاس رو تعریف می‌کنه که می‌تونین روی `app` در مثال بالا تست کنید. چند نمونه مهم از این متد‌ها `name` و `logger` و `make_config` و ‍‍`make_shell_context` و `debug` و ‍`test_client` و `register_blueprint` و `add_url_rule` و `run` هستن.
حالا چرا `Flask` رو با `__name__` به کار میبریم؟ برای این اول باید متغیر‌‌های داندر رو توی پایتون معرفی کنیم. متغیر‌های داندر متغیر‌هایی هستن که پایتون خودش اونها رو تعریف می‌کنه و به شیوه‌های مختلف می‌تونن مورد استفاده قرار بگیرن و در مواقعی بسیار به کار می‌آن. البته این به این معنی نیست که ما نمی‌تونیم این متغیر‌ها رو تعریف کنیم. یک مثال خیلی مرسوم اینه که متغیر‌های `__author__` و `__license__` هستن. اما بذارید قبل از اون  همه متغیر‌های یک برنامه پایتون رو چک کنیم تا بتونیم متغیر‌های داندر هم توشون ببینیم.
بذارید اول این کار رو توی شل پایتون انجام بدیم.
``` Python
>>> dir() # see all variables in an app
['__annotations__', '__builtins__', '__doc__', '__loader__', '__name__', '__package__', '__spec__']
>>> test_variable = 'test_variable'
>>> dir() # see all variables in an app
['__annotations__', '__builtins__', '__doc__', '__loader__', '__name__', '__package__', '__spec__', 'my_variable']

```
و حالا بریم سراغ فایل
``` Python
#app.py
print(dir())
```
``` Shell
python app.py
['__annotations__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__']
```
البته این‌ها برای یه برنامه خالین و منطقا هر متغیر, تابع کلاس و ... دیگه‌ای تعریف کنیم کلی از این متغیر‌ها می‌گیره.

خب حالا باید ببینیم چرا به کلاس `Flask`, متغیر `__name__` رو میدیم. در واقع یکی از دلایل این کار اینه که فلسک بفهمه ریشه یا همون `instance` ما کجاست و بر اساس همون `template` ها و خیلی چیزای دیگه‌رو لود کنه.